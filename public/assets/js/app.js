"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Filter=function t(i,e,s){_classCallCheck(this,t),$(i).keyup(function(){$(e).children().stop().fadeOut("fast",function(){$(e).children().each(function(){var t=$(this),e=t.find(s).text(),a=$(i).val();a.length<1?t.fadeIn("fast"):wanakana.isJapanese(e)?(console.log(e.toRomaji().toLowerCase()),1<e.toRomaji().toLowerCase().indexOf(a.toRomaji().toLocaleLowerCase())&&t.fadeIn("fast")):-1<transl(e).toLowerCase().indexOf(transl(a).toLowerCase())&&t.fadeIn("fast")})})})};$(document).ready(function(){$(window).resize(function(){$("main").css({"margin-top":$("header").height(),"margin-bottom":$("footer").height()})}).resize(),new Filter("#filter-bar","#items",".item-title");var i=new Player("#song","#player");$(document).on("click",".play-song",function(){t($(this))});var t=function(t){i.pause();var e=parseInt(t.attr("rel")),a=[];$(".play-song").each(function(){parseInt($(this).attr("rel"))>=e&&a.push({type:$(this).data("type"),src:$(this).data("src"),title:$(this).data("title"),artist:$(this).data("artist"),album:$(this).data("album")})}),i.setType(t.data("type")).setSrc(t.data("src")).title(t.data("title")).artist(t.data("artist")).album(t.data("album")).play(!0,a)}}),Number.prototype.timeFormat=function(){var t=Math.ceil(this.valueOf()),e=t%60;return Math.floor(t/60)+":"+(e<10?"0"+e:e)};var _createClass=function(){function i(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,a){return e&&i(t.prototype,e),a&&i(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Player=function(){function i(t,e){_classCallCheck(this,i),this.audio=$(t),this.player=$(e),this.status="stopped",this.data={},this.queue=null,this.originalTitle=document.title;var a=this;this.audio.on("timeupdate",function(){var t=a.audio[0].currentTime,e=a.audio[0].duration;t&&e&&(t<e?(a.player.find(".progress-bar").css("width",t/e*100+"%"),a.player.find(".progress-time").html("<i>"+t.timeFormat()+"</i>/"+e.timeFormat())):a.next())}),this.player.find(".toggle-play").click(function(){"playing"!==a.status?a.play():a.pause()}),this.player.find(".play-prev").click(function(){2<a.audio[0].currentTime?a.restart():a.previous()}),this.player.find(".play-next").click(function(){a.next()}),this.player.find(".list-queue").click(function(){a.listQueue()})}return _createClass(i,[{key:"play",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(this.audio.trigger("play"),t&&(this.player.find(".title").html(this.data.title),this.player.find(".artist").html(this.data.artist),this.player.find(".album").html(this.data.album),document.title=this.data.title+" - "+this.data.artist+" | chilii Music Player",e&&(this.queue=new Queue(e)),this.queue)){var a=this.player.find(".queue");a.hasClass("open")&&a.slideUp("fast",function(){a.removeClass("open")})}return this.player.find(".fa-play").removeClass("fa-play").addClass("fa-pause"),this.status="playing",this}},{key:"pause",value:function(){return this.audio.trigger("pause"),this.player.find(".fa-pause").removeClass("fa-pause").addClass("fa-play"),this.status="paused",this}},{key:"restart",value:function(){return this.audio[0].currentTime=0,this}},{key:"stop",value:function(){return this.pause().restart(),document.title=this.originalTitle,this}},{key:"previous",value:function(){if(this.previousHandler)this.previousHandler();else if(this.queue){var t=this.queue.previous();this.setType(t.type).setSrc(t.src).title(t.title).artist(t.artist).album(t.album).play(!0)}}},{key:"next",value:function(){if(this.nextHandler)this.nextHandler();else if(this.queue){var t=this.queue.next();this.setType(t.type).setSrc(t.src).title(t.title).artist(t.artist).album(t.album).play(!0)}}},{key:"title",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return t?(this.data.title=t,this):this.data.title}},{key:"artist",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return t?(this.data.artist=t,this):this.data.artist}},{key:"album",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return t?(this.data.album=t,this):this.data.album}},{key:"setType",value:function(t){return this.type=t,this.audio.attr("type",this.type),this}},{key:"setSrc",value:function(t){return this.src=t,this.audio.attr("src",t),this}},{key:"listQueue",value:function(){var t=this.player.find(".queue");if(t.hasClass("open"))t.slideUp("fast",function(){t.removeClass("open")});else{var e=this.queue.list(),a=this.queue.currentIndex();t.html("");for(var i=0;i<e.length;i++)t.append("<span"+(i===a?' class="current"':"")+">"+e[i].title+" - "+e[i].artist+"</span>");t.slideDown("fast",function(){t.addClass("open")})}return this}},{key:"setPreviousHandler",value:function(t){return this.previousHandler=t,this}},{key:"setNextHandler",value:function(t){return this.nextHandler=t,this}}]),i}();_createClass=function(){function i(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,a){return e&&i(t.prototype,e),a&&i(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Queue=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,e),this.items=t,this.iterator=0}return _createClass(e,[{key:"previous",value:function(){return 0<this.iterator&&this.iterator--,this.current()}},{key:"next",value:function(){return this.iterator<this.items.length-1&&this.iterator++,this.current()}},{key:"current",value:function(){return this.items[this.iterator]}},{key:"currentIndex",value:function(){return this.iterator}},{key:"list",value:function(){return this.items}},{key:"add",value:function(t){return this.items.push(t),this}}]),e}();String.prototype.toRomaji=function(){return(new Kuroshiro).convert(this.valueOf(),{to:"romaji"})};